#lang racket

(require "uniquify.rkt"
         "sequentialize-let.rkt"
         "normalize-bind.rkt"
         "select-instructions.rkt"
         "replace-locations.rkt"
         "assign-fvars.rkt"
         "uncover-locals.rkt"
         "flatten-begins.rkt"
         "patch-instructions.rkt"
         "implement-fvars.rkt")

(define (test p)
  (implement-fvars
   (patch-instructions
    (flatten-begins
     (uncover-locals
      (assign-fvars
       (replace-locations
        (select-instructions
         (normalize-bind
          (sequentialize-let
           (uniquify p)))))))))))